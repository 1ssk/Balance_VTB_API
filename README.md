# Проект для проверки баланса счета и карт

Этот проект предоставляет API для проверки баланса счета и карт с использованием банковского API. В проекте реализованы два основных функционала:

1. Получение токена для аутентификации.
2. Проверка баланса аккаунтов и карт.

## Структура проекта

```
myproject/
│
├── main.go                # Точка входа в приложение
├── handlers/              # Обработчики для маршрутов
│   ├── balance.go         # Обработчик запроса баланса
│   └── index.go           # Обработчик главной страницы
├── models/                # Структуры данных для запросов и ответов
│   └── response.go        # Структуры для хранения информации о балансе
├── utils/                 # Вспомогательные функции
│   └── auth.go            # Функции для аутентификации и запросов
├── templates/             # HTML-шаблоны
│   └── index.html         # Главная страница
├── .env                   # Файл с переменными окружения
├── go.mod                 # Модуль Go
├── go.sum                 # Контрольные суммы модулей
└── README.md              # Документация проекта
```

## Установка

1. Скачайте или клонируйте проект на свой компьютер:

    ```bash
    git clone https://github.com/1ssk/Balance_VTB_API.git
    ```

2. Перейдите в директорию проекта:

    ```bash
    cd Balance_VTB_API-master
    ```

3. Установите зависимости:

    ```bash
    go mod tidy
    ```

4. Создайте файл `.env` в корневой директории проекта и добавьте в него свои данные для аутентификации:

    ```
    login=your_client_id
    password=your_client_secret
    ```

## Запуск приложения

1. Для запуска сервера используйте команду:

    ```bash
    go run main.go
    ```

    Сервер будет доступен по адресу: `http://localhost:8080`.

2. Откройте в браузере `http://localhost:8080` для проверки главной страницы.

3. Для проверки баланса счета и карт, откройте `http://localhost:8080/account/balance`.

## Описание компонентов

### `main.go`

Основной файл приложения, где запускается сервер и обрабатываются маршруты:

- `/` — Главная страница.
- `/account/balance` — Запрос на получение информации о балансе.

### `handlers/`

- **`index.go`** — Обработчик для главной страницы, которая отображается при переходе по `/`.
- **`balance.go`** — Обработчик для маршрута `/account/balance`, который получает баланс счета и карт.

### `models/`

- **`response.go`** — Содержит структуры данных, которые используются для обмена информацией с API:
    - `Account` — Структура для счета или карты.
    - `BalanceResponse` — Структура, которая объединяет счета и карты с их балансами.

### `utils/`

- **`auth.go`** — Вспомогательные функции для получения токена аутентификации и выполнения запроса к внешнему API для получения баланса:
    - `GetAccessToken` — Функция для получения токена аутентификации.
    - `FetchBalance` — Функция для получения данных о балансе.

### Шаблоны

- **`index.html`** — HTML-шаблон для отображения главной страницы.

## Переменные окружения

Для правильной работы проекта необходимо создать файл `.env` в корневой директории и задать следующие переменные:

```
login=your_client_id
password=your_client_secret
```

`login` и `password` — это данные для аутентификации в внешнем API.

## Используемые библиотеки

- `gorilla/mux` — Для маршрутизации HTTP запросов.
- `rs/cors` — Для настройки CORS.
- `joho/godotenv` — Для работы с переменными окружения.
- Стандартные библиотеки Go для HTTP запросов, обработки JSON и работы с TLS.

## Примечания

- В проекте используется отключенная проверка SSL-сертификатов для тестовых целей (`InsecureSkipVerify: true`). Для продакшен-окружения **обязательно** включите проверку сертификатов.
- Внимание! Убедитесь, что вы не оставляете `.env` файл с клиентскими данными в публичных репозиториях.

## Пример ответа API

### Ответ на запрос `/account/balance`

Пример успешного ответа (JSON):

```json
{
  "accounts": [
    {
      "id": "8b3a2a7e-9148-44f4-9136-f10bdece01d7",
      "balance": {
        "amount": 5000,
        "currency": {
          "code": "RUB"
        }
      }
    }
  ],
  "cards": [
    {
      "id": "07ae0ada-2088-4a06-a342-0a5baf6902ac",
      "balance": {
        "amount": 3000,
        "currency": {
          "code": "RUB"
        }
      }
    }
  ]
}
```

### Ответ на ошибку

Пример ошибки в случае неудачного запроса:

```json
{
  "error": "Unauthorized",
  "message": "Invalid client credentials"
}
```
